(function(e,c,a,g){var d="countdown360",f={radius:15.5,strokeStyle:"#477050",strokeWidth:g,fillStyle:"#8ac575",fontColor:"#477050",fontFamily:"sans-serif",fontSize:g,fontWeight:700,autostart:true,seconds:10,label:["second","seconds"],startOverAfterAdding:true,onComplete:function(){}};function b(i,h){this.element=i;this.settings=e.extend({},f,h);if(!this.settings.fontSize){this.settings.fontSize=this.settings.radius/1.2}if(!this.settings.strokeWidth){this.settings.strokeWidth=this.settings.radius/4}this._defaults=f;this._name=d;this._init()}b.prototype={extendTimer:function(i){var j=parseInt(i),h=Math.round((new Date().getTime()-this.startedAt.getTime())/1000);if((this._secondsLeft(h)+j)<=this.settings.seconds){this.startedAt.setSeconds(this.startedAt.getSeconds()+parseInt(i))}},addSeconds:function(i){var h=Math.round((new Date().getTime()-this.startedAt.getTime())/1000);if(this.settings.startOverAfterAdding){this.settings.seconds=this._secondsLeft(h)+parseInt(i);this.start()}else{this.settings.seconds+=parseInt(i)}},start:function(){this.startedAt=new Date();this._drawCountdownShape(Math.PI*3.5,true);this._drawCountdownLabel(0);this.interval=setInterval(jQuery.proxy(this._draw,this),1000)},stop:function(h){clearInterval(this.interval);if(h){h()}},_init:function(){this.settings.width=(this.settings.radius*2)+(this.settings.strokeWidth*2);this.settings.height=this.settings.width;this.settings.arcX=this.settings.radius+this.settings.strokeWidth;this.settings.arcY=this.settings.arcX;this._initPen(this._getCanvas());if(this.settings.autostart){this.start()}},_getCanvas:function(){var h=e('<canvas id="countdown360_'+e(this.element).attr("id")+'" width="'+this.settings.width+'" height="'+this.settings.height+'"><span id="countdown-text" role="status" aria-live="assertive"></span></canvas>');e(this.element).prepend(h[0]);return h[0]},_initPen:function(h){this.pen=h.getContext("2d");this.pen.lineWidth=this.settings.strokeWidth;this.pen.strokeStyle=this.settings.strokeStyle;this.pen.fillStyle=this.settings.fillStyle;this.pen.textAlign="center";this.pen.textBaseline="middle";this.ariaText=e(h).children("#countdown-text");this._clearRect()},_clearRect:function(){this.pen.clearRect(0,0,this.settings.width,this.settings.height)},_secondsLeft:function(h){return this.settings.seconds-h},_drawCountdownLabel:function(k){this.ariaText.text(l);this.pen.font=this.settings.fontWeight+" "+this.settings.fontSize+"px "+this.settings.fontFamily;var l=this._secondsLeft(k),j=l===1?this.settings.label[0]:this.settings.label[1],i=this.settings.label&&this.settings.label.length===2,h=this.settings.width/2;if(i){y=this.settings.height/2-(this.settings.fontSize/6.2)}else{y=this.settings.height/2}this.pen.fillStyle=this.settings.fillStyle;this.pen.fillText(l+1,h,y);this.pen.fillStyle=this.settings.fontColor;this.pen.fillText(l,h,y);if(i){this.pen.font="normal small-caps "+(this.settings.fontSize/3)+"px "+this.settings.fontFamily;this.pen.fillText(j,this.settings.width/2,this.settings.height/2+(this.settings.fontSize/2.2))}},_drawCountdownShape:function(i,h){this.pen.fillStyle=this.settings.fillStyle;this.pen.beginPath();this.pen.arc(this.settings.arcX,this.settings.arcY,this.settings.radius,Math.PI*1.5,i,false);this.pen.fill();if(h){this.pen.stroke()}},_draw:function(){var i=Math.round((new Date().getTime()-this.startedAt.getTime())/1000),h=(Math.PI*3.5)-(((Math.PI*2)/this.settings.seconds)*i);this._clearRect();this._drawCountdownShape(Math.PI*3.5,false);if(i<this.settings.seconds){this._drawCountdownShape(h,true);this._drawCountdownLabel(i)}else{this._drawCountdownLabel(this.settings.seconds);this.stop();this.settings.onComplete()}}};e.fn[d]=function(h){var i;this.each(function(){i=e.data(this,"plugin_"+d);if(!i){i=new b(this,h);e.data(this,"plugin_"+d,i)}});return i}})(jQuery,window,document);